{
	"info": {
		"_postman_id": "d47a140e-a7cb-49f9-9fdf-d434509b8abf",
		"name": "OneNote API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "NOTEBOOKS",
			"item": [
				{
					"name": "POST",
					"item": [
						{
							"name": "GetNotebooksFromWebUrls at Me",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\"webUrls\":[{{WebUrls}}]}"
								},
								"url": {
									"raw": "{{MeNotebooks}}/GetNotebooksFromWebUrls",
									"host": [
										"{{MeNotebooks}}"
									],
									"path": [
										"GetNotebooksFromWebUrls"
									]
								},
								"description": "Gets the notebooks for a list of onenote weburls"
							},
							"response": []
						},
						{
							"name": "GetNotebookFromWebUrl at Me",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\"webUrl\":\"{{WebUrl}}\"}"
								},
								"url": {
									"raw": "{{MeNotebooks}}/GetNotebookFromWebUrl",
									"host": [
										"{{MeNotebooks}}"
									],
									"path": [
										"GetNotebookFromWebUrl"
									]
								},
								"description": "Gets the notebooks for a list of onenote weburls"
							},
							"response": []
						},
						{
							"name": "GetNotebookFromWebUrl at User",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"type": "text",
										"value": "{{AppIdHeader_Value}}"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\"webUrl\":\"{{WebUrl}}\"}"
								},
								"url": {
									"raw": "{{UserNotebooks}}/GetNotebookFromWebUrl",
									"host": [
										"{{UserNotebooks}}"
									],
									"path": [
										"GetNotebookFromWebUrl"
									]
								},
								"description": "Gets the notebooks for a list of onenote weburls"
							},
							"response": []
						},
						{
							"name": "CreateNewNotebook",
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": ""
								}
							},
							"response": []
						}
					],
					"description": "All available POST actions in Notebooks API",
					"_postman_isSubFolder": true
				},
				{
					"name": "GET",
					"item": [
						{
							"name": "GetRecentNotebooks(IncludePersonalNotebooks)",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MeNotebooks}}/GetRecentNotebooks(includePersonalNotebooks=true)",
									"host": [
										"{{MeNotebooks}}"
									],
									"path": [
										"GetRecentNotebooks(includePersonalNotebooks=true)"
									]
								},
								"description": "Gets all the recent notebooks of a user including personal notebooks."
							},
							"response": []
						},
						{
							"name": "Get All Notebooks at Me",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MeNotebooks}}",
									"host": [
										"{{MeNotebooks}}"
									]
								}
							},
							"response": []
						}
					],
					"description": "All notebooks GET functions",
					"_postman_isSubFolder": true
				}
			]
		},
		{
			"name": "WOPI",
			"item": [
				{
					"name": "GET",
					"item": [
						{
							"name": "go",
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{WopiHost}}/go",
									"host": [
										"{{WopiHost}}"
									],
									"path": [
										"go"
									]
								}
							},
							"response": []
						},
						{
							"name": "go/newpage",
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{WopiHost}}/go/newpage",
									"host": [
										"{{WopiHost}}"
									],
									"path": [
										"go",
										"newpage"
									]
								}
							},
							"response": []
						},
						{
							"name": "ping  host",
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{WOPIEndpoint}}/ping",
									"host": [
										"{{WOPIEndpoint}}"
									],
									"path": [
										"ping"
									]
								},
								"description": "Pings the WOPI host endpoint."
							},
							"response": []
						}
					],
					"description": "All the WOPI GET Requests.",
					"_postman_isSubFolder": true
				}
			],
			"description": "Wopi endpoints."
		},
		{
			"name": "RESOURCES",
			"item": [
				{
					"name": "GET",
					"item": [
						{
							"name": "Get Resource Value By Id",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MeResources}}/{{ResourceId}}/$value",
									"host": [
										"{{MeResources}}"
									],
									"path": [
										"{{ResourceId}}",
										"$value"
									]
								},
								"description": "Gets a resource by using the provided ID"
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				}
			]
		},
		{
			"name": "SECTIONGROUPS",
			"item": [
				{
					"name": "GET",
					"item": [
						{
							"name": "Get All SectionGroups at Me",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"type": "text",
										"value": "{{AppIdHeader_Value}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MeSectionGroups}}",
									"host": [
										"{{MeSectionGroups}}"
									]
								}
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				}
			],
			"description": "All GET requests for section groups"
		},
		{
			"name": "PAGES",
			"item": [
				{
					"name": "GET",
					"item": [
						{
							"name": "Get All Pages at Me",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MePages}}",
									"host": [
										"{{MePages}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Page Content at Me",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MePages}}/{{PageId}}/content?includeIds=true",
									"host": [
										"{{MePages}}"
									],
									"path": [
										"{{PageId}}",
										"content"
									],
									"query": [
										{
											"key": "includeIds",
											"value": "true"
										}
									]
								}
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				},
				{
					"name": "PATCH",
					"item": [
						{
							"name": "Insert Before Target",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "[\r\n  {\r\n    \"action\": \"insert\",\r\n    \"position\": \"before\",\r\n    \"target\": \"{{Target_Id}}\",\r\n    \"content\": \"{{HTMLContent}}\"\r\n  }\r\n]"
								},
								"url": {
									"raw": "{{MePages}}/{{PageId}}/content",
									"host": [
										"{{MePages}}"
									],
									"path": [
										"{{PageId}}",
										"content"
									]
								},
								"description": "This requests inserts a new todo item and replaces the old item with an empty block. It tries to work around a known bug where the list would break if user updates the todo item by itself."
							},
							"response": []
						},
						{
							"name": "Replace Target",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "26267e5b-be2d-47e4-bd45-172604fa1b4a",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"type": "text",
										"value": "{{AppIdHeader_Value}}"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "[\r\n  {\r\n    \"action\": \"replace\",\r\n    \"target\": \"{{Target_Id}}\",\r\n    \"content\":\"{{HTMLContent}}\"\r\n  }\r\n]"
								},
								"url": {
									"raw": "{{MePages}}/{{PageId}}/content",
									"host": [
										"{{MePages}}"
									],
									"path": [
										"{{PageId}}",
										"content"
									]
								},
								"description": "This requests inserts a new todo item and replaces the old item with an empty block. It tries to work around a known bug where the list would break if user updates the todo item by itself."
							},
							"response": []
						}
					],
					"description": "All available notebooks patch requests",
					"_postman_isSubFolder": true
				}
			],
			"description": "All Get requests for Pages."
		},
		{
			"name": "SECTIONS",
			"item": [
				{
					"name": "GET",
					"item": [
						{
							"name": "Get All Sections at Me",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"type": "text",
										"value": "{{AppIdHeader_Value}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MeSections}}",
									"host": [
										"{{MeSections}}"
									]
								}
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				},
				{
					"name": "POST",
					"item": [
						{
							"name": "Create a Section in Notebook",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\"name\":\"{{Test_Title}}\"}"
								},
								"url": {
									"raw": "{{MeNotebooks}}/{{NotebookId}}/sections",
									"host": [
										"{{MeNotebooks}}"
									],
									"path": [
										"{{NotebookId}}",
										"sections"
									]
								},
								"description": "Creates a new section under the provided notebook id."
							},
							"response": []
						},
						{
							"name": "Create a Section in SectionGroup",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"value": "{{AppIdHeader_Value}}",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"value": "application/json",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\"name\":\"{{Test_Title-Japanese}}\"}"
								},
								"url": {
									"raw": "{{MeNotebooks}}/{{SectionGroupId}}/sections",
									"host": [
										"{{MeNotebooks}}"
									],
									"path": [
										"{{SectionGroupId}}",
										"sections"
									]
								},
								"description": "Creates a new section under the provided notebook id."
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				}
			],
			"description": "All Get Requests for Sections"
		},
		{
			"name": "CLASSNOTEBOOKS",
			"item": [
				{
					"name": "GET",
					"item": [
						{
							"name": "Get all class notebooks at Me",
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "{{AppIdHeader}}",
										"type": "text",
										"value": "{{AppIdHeader_Value}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{MeClassNotebooks}}?hasaccessto=true",
									"host": [
										"{{MeClassNotebooks}}"
									],
									"query": [
										{
											"key": "hasaccessto",
											"value": "true",
											"description": "Returns all class notebooks that the user has access to."
										}
									]
								},
								"description": "Gets all notebooks from classnotebooks"
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				}
			],
			"description": "All endpoints for ClassNotebooks requests"
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{{{AuthToken}}}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "4fcc87ca-73a0-4014-93cd-88c9089ecd59",
				"type": "text/javascript",
				"exec": [
					"const AuthTokenName = \"AuthToken\";",
					"const AuthTokenExpName = \"AuthTokenExp\";",
					"const AuthTokenUrlName = \"AuthTokenUrl\";",
					"const ClientIdName = \"ClientId\";",
					"const passwordName = \"password\";",
					"const usernameName = \"username\";",
					"const resource = \"https://officeapps.live.com\";",
					"const scope = \"openid\";",
					"",
					"// Object used to request an authtoken",
					"// Based on currently selected postman environment",
					"const echoPostRequest = {",
					"  url:getGlobalVarThroughEnvironmentVar(AuthTokenUrlName),",
					"  method: 'POST',",
					"    body: {",
					"            mode: 'urlencoded',",
					"            urlencoded: [",
					"                    { key: \"grant_type\", value: \"password\" },",
					"                    { key: \"username\", value:  getGlobalVarThroughEnvironmentVar(usernameName)},",
					"                    { key: \"password\", value: getGlobalVarThroughEnvironmentVar(passwordName) },",
					"                    { key: \"resource\", value: resource },",
					"                    { key: \"scope\", value: scope },",
					"                    { key: \"client_id\", value: getGlobalVarThroughEnvironmentVar(ClientIdName)}",
					"            ]",
					"        }",
					"}",
					"",
					"// Verify if the AuthToken needs to be refreshed",
					"if (!getGlobalVarThroughEnvironmentVar(AuthTokenName) || ",
					"    !getGlobalVarThroughEnvironmentVar(AuthTokenExpName)) {",
					"    console.log('AuthToken or expiry date are missing')",
					"    requestAuthToken();",
					"}",
					"else if (getGlobalVarThroughEnvironmentVar(AuthTokenExpName) <= (new Date()).getTime()) {",
					"    console.log('AuthToken is expired')",
					"    requestAuthToken();",
					"}",
					"else {",
					"    console.log(\"Current AuthToken is still valid.\");",
					"}",
					"",
					"// Makes a request to bet a new AuthToken.",
					"// This will store the new auth token as a global variable.",
					"function requestAuthToken (){",
					"    pm.sendRequest(echoPostRequest, function (err, res) {",
					"    console.log(err ? err : res.json());",
					"        if (err === null) {",
					"            console.log('Saving the token and expiry date')",
					"            var responseJson = res.json();",
					"            setGlobalVarThroughEnvironmentVar(AuthTokenName, responseJson.access_token)",
					"    ",
					"            var expiryDate = new Date();",
					"            expiryDate.setSeconds(expiryDate.getSeconds() + responseJson.expires_in);",
					"            setGlobalVarThroughEnvironmentVar(AuthTokenExpName, expiryDate.getTime());",
					"        }",
					"    });",
					"}",
					"",
					"// Using an env variable to grab the global variable allows us to avoid checking for what env we are running on here. Instead we rely on postman's current env selection to search for the right global variable. See how globals are setup (they are basically a collection of both prod and ppe environment variables that are selected based on the env we are running)",
					"function getGlobalVarThroughEnvironmentVar(varName){",
					"    return pm.globals.get(pm.environment.get(varName));",
					"}",
					"",
					"function setGlobalVarThroughEnvironmentVar(varName, value){",
					"    return pm.globals.set(pm.environment.get(varName),value);",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "e1141f29-244d-41b0-b308-74478dc4f2c0",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "944ea569-9ccb-4142-bafe-1f91d21966ec",
			"key": "AppIdHeader",
			"value": "MS-Int-AppId",
			"type": "string"
		},
		{
			"id": "a5c1724e-4999-43ed-b313-903cca95072a",
			"key": "AppIdHeader_Value",
			"value": "Testing",
			"type": "string"
		},
		{
			"id": "4974d457-4da1-41a5-af81-1831e596c16c",
			"key": "Me",
			"value": "{{Site}}/api/{{version}}/me",
			"type": "string"
		},
		{
			"id": "98d97588-53a7-47df-a421-2540f3392088",
			"key": "MeNotebooks",
			"value": "{{Me}}/notes/notebooks",
			"type": "string"
		},
		{
			"id": "8a38cd0e-1221-4e30-bc41-4bdb76007981",
			"key": "User",
			"value": "{{Site}}/api/{{version}}/users('{{UserId}}')",
			"type": "string"
		},
		{
			"id": "a84f3e15-d116-4895-8473-1dfb4af2c1f9",
			"key": "UserNotebooks",
			"value": "{{User}}/notes/notebooks",
			"type": "string"
		},
		{
			"id": "833b68bc-877e-4431-af63-063cb61a058b",
			"key": "MeClassNotebooks",
			"value": "{{Me}}/notes/classnotebooks",
			"type": "string"
		},
		{
			"id": "de23dabd-833f-45e0-acaf-a53a5052736d",
			"key": "MeSections",
			"value": "{{Me}}/notes/sections",
			"type": "string"
		},
		{
			"id": "46e64f47-3f5b-4c0c-a02f-9165393e5f07",
			"key": "MeSectionGroups",
			"value": "{{Me}}/notes/sectiongroups",
			"type": "string"
		},
		{
			"id": "47ac2929-6a60-48df-89fb-a9b5ef8477c6",
			"key": "MeResources",
			"value": "{{Me}}/notes/resources",
			"type": "string"
		},
		{
			"id": "c97bf9e3-e619-4041-b05d-68e39c29e730",
			"key": "WopiHost",
			"value": "{{Site}}/host",
			"type": "string"
		},
		{
			"id": "292036fb-4115-4346-b358-d2ed84285c68",
			"key": "WOPIEndpoint",
			"value": "{{Site}}/sync/{{WOPIVersion}}/Wopi",
			"type": "string"
		},
		{
			"id": "ce78324b-56f2-4721-bbae-ecf20b252ff3",
			"key": "MePages",
			"value": "{{Me}}/notes/pages",
			"type": "string"
		},
		{
			"id": "ee2c2a0f-1a8d-4c3e-82a5-a86161dde602",
			"key": "Target_Body",
			"value": "body",
			"type": "string"
		},
		{
			"id": "e003e729-3bfe-4eca-8e9d-886e06b237b8",
			"key": "UserId",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "2b6cd8eb-e3d4-4eef-ae3b-3d8dcd253b88",
			"key": "PageId",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "b047d47d-c99a-44c5-935d-971b9a5fb87a",
			"key": "SectionId",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "9ee943e5-60a1-44a5-a0c8-aafa8de86a27",
			"key": "SectionGroupId",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "97b5fc7d-886c-4bbb-a00e-052c08cf92d4",
			"key": "NotebookId",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "4c8bb370-0c98-4dad-9781-fe46b8626e12",
			"key": "ResourceId",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "9c29be8a-392d-444b-9207-6b02d6ff120c",
			"key": "MachineName",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "8e81cc0a-8361-415f-877e-da7185c1037c",
			"key": "WebUrl",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "2837b63e-520d-478c-a736-737ccb26f2ea",
			"key": "WebUrls",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "95dd85aa-9856-49f5-9a65-3942dd5b30f1",
			"key": "Target_Id",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "35c8ad64-c57d-4459-b84e-a99e7e630ba6",
			"key": "HTMLContent",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "d24a5daa-1561-4583-8905-82ca4bb0df26",
			"key": "Test_Title",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "38a5a4e4-c6aa-458a-9e08-35ae790e81ce",
			"key": "Test_JapaneseTitle",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		},
		{
			"id": "d6df31e0-8442-431f-a219-f37b76983e53",
			"key": "NotebookName",
			"value": "<Update current value only, leave this initial value as is>",
			"type": "string"
		}
	]
}